<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Ports Ocean - 네트워크 포트 학습 플랫폼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #001e3c 0%, #003d7a 50%, #0056b3 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .ocean-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0,191,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(30,144,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(0,206,209,0.1) 0%, transparent 50%);
        }

        .bubbles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .bubble {
            position: absolute;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(100vh) scale(0); opacity: 1; }
            100% { transform: translateY(-100px) scale(1); opacity: 0; }
        }

        .header {
            position: relative;
            padding: 2rem;
            text-align: center;
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .title {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(45deg, #00bfff, #1e90ff, #00ced1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            text-shadow: 0 0 30px rgba(0,191,255,0.5);
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 10px 15px;
            background: rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 25px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 12px;
        }

        .control-btn:hover {
            background: rgba(0,191,255,0.5);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,191,255,0.3);
        }

        .control-btn.active {
            background: linear-gradient(45deg, #00bfff, #1e90ff);
            box-shadow: 0 0 20px rgba(0,191,255,0.5);
        }

        .lang-selector {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }

        .lang-btn {
            padding: 8px 12px;
            margin: 2px;
            background: rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 11px;
        }

        .lang-btn:hover, .lang-btn.active {
            background: linear-gradient(45deg, #00bfff, #1e90ff);
            transform: translateY(-1px);
        }

        .main-container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        .search-container {
            margin: 2rem 0;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 30px;
            color: white;
            font-size: 16px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #00bfff;
            box-shadow: 0 0 30px rgba(0,191,255,0.3);
        }

        .search-input::placeholder {
            color: rgba(255,255,255,0.6);
        }

        .filters {
            display: flex;
            gap: 10px;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 14px;
        }

        .filter-btn:hover, .filter-btn.active {
            background: linear-gradient(45deg, #00bfff, #1e90ff);
            transform: translateY(-1px);
        }

        .ports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin: 2rem 0;
        }

        .port-card {
            background: rgba(0,0,0,0.6);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            transition: all 0.5s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .port-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(0,191,255,0.1), transparent);
            animation: rotate 4s linear infinite;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .port-card:hover::before {
            opacity: 1;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        .port-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,191,255,0.3);
            border-color: #00bfff;
        }

        .port-number {
            font-size: 2rem;
            font-weight: bold;
            color: #00bfff;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(0,191,255,0.5);
        }

        .port-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .port-protocol {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            border-radius: 20px;
            font-size: 0.8rem;
            margin: 5px 5px 10px 0;
            text-transform: uppercase;
            font-weight: bold;
        }

        .port-description {
            color: rgba(255,255,255,0.8);
            line-height: 1.5;
            margin: 10px 0;
        }

        .port-details {
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 3px solid #00bfff;
        }

        .detail-item {
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .detail-label {
            font-weight: bold;
            color: #00ced1;
        }

        .detail-value {
            color: rgba(255,255,255,0.9);
        }

        .security-level {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .security-low { background: linear-gradient(45deg, #4ecdc4, #44a08d); }
        .security-medium { background: linear-gradient(45deg, #f7971e, #ffd200); color: #333; }
        .security-high { background: linear-gradient(45deg, #ff6b6b, #ee5a24); }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(20px);
        }

        .modal-content {
            background: rgba(0,0,0,0.9);
            border: 2px solid #00bfff;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            backdrop-filter: blur(20px);
            box-shadow: 0 0 50px rgba(0,191,255,0.3);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #00bfff;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 2rem 0;
        }

        .stat-card {
            background: rgba(0,0,0,0.6);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,191,255,0.2);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00bfff;
            display: block;
        }

        .stat-label {
            color: rgba(255,255,255,0.8);
            margin-top: 5px;
        }

        .wave {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,0V60c200,40,400-40,600,0s400-40,600,0V0Z" fill="rgba(0,191,255,0.1)"/></svg>');
            background-size: 1200px 100px;
            animation: wave 10s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes wave {
            0%, 100% { transform: translateX(0px); }
            50% { transform: translateX(-100px); }
        }

        .loading-spinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3000;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid #00bfff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .title { font-size: 2rem; }
            .ports-grid { grid-template-columns: 1fr; }
            .controls { position: relative; top: auto; right: auto; justify-content: center; margin: 1rem 0; }
            .lang-selector { position: relative; top: auto; left: auto; text-align: center; margin: 1rem 0; }
        }

        .transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #001e3c, #003d7a);
            z-index: 5000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .transition-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
    </style>
</head>
<body>
    <div class="ocean-bg"></div>
    <div class="bubbles" id="bubbles"></div>
    <div class="wave"></div>
    <div class="transition-overlay" id="transitionOverlay"></div>
    
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
    </div>

    <div class="lang-selector">
        <button class="lang-btn active" onclick="setLanguage('ko')">한국어</button>
        <button class="lang-btn" onclick="setLanguage('en')">English</button>
        <button class="lang-btn" onclick="setLanguage('zh')">中文</button>
        <button class="lang-btn" onclick="setLanguage('ja')">日本語</button>
    </div>

    <div class="controls">
        <button class="control-btn active" id="effects3d" onclick="toggle3DEffects()">3D 효과</button>
        <button class="control-btn active" id="animations" onclick="toggleAnimations()">애니메이션</button>
        <button class="control-btn active" id="particles" onclick="toggleParticles()">파티클</button>
        <button class="control-btn active" id="sounds" onclick="toggleSounds()">사운드</button>
    </div>

    <div class="header">
        <h1 class="title" id="mainTitle">Network Ports Ocean</h1>
        <p id="subtitle">네트워크 포트를 바다 속에서 탐험하며 학습하세요</p>
    </div>

    <div class="main-container">
        <div class="stats-container">
            <div class="stat-card">
                <span class="stat-number" id="totalPorts">1024</span>
                <div class="stat-label" id="totalPortsLabel">총 포트 수</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="learnedPorts">0</span>
                <div class="stat-label" id="learnedPortsLabel">학습한 포트</div>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="progress">0%</span>
                <div class="stat-label" id="progressLabel">학습 진도</div>
            </div>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="포트 번호나 서비스명으로 검색...">
        </div>

        <div class="filters">
            <button class="filter-btn active" onclick="filterPorts('all')" id="filterAll">전체</button>
            <button class="filter-btn" onclick="filterPorts('well-known')" id="filterWellKnown">잘 알려진 포트 (0-1023)</button>
            <button class="filter-btn" onclick="filterPorts('registered')" id="filterRegistered">등록된 포트 (1024-49151)</button>
            <button class="filter-btn" onclick="filterPorts('dynamic')" id="filterDynamic">동적 포트 (49152-65535)</button>
            <button class="filter-btn" onclick="filterPorts('tcp')" id="filterTCP">TCP</button>
            <button class="filter-btn" onclick="filterPorts('udp')" id="filterUDP">UDP</button>
        </div>

        <div class="ports-grid" id="portsGrid">
            <!-- Ports will be loaded here -->
        </div>
    </div>

    <div class="modal" id="portModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <div id="modalContent">
                <!-- Modal content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentLanguage = 'ko';
        let settings = {
            effects3d: true,
            animations: true,
            particles: true,
            sounds: false
        };
        let allPorts = [];
        let filteredPorts = [];
        let learnedPorts = new Set();

        // Language translations
        const translations = {
            ko: {
                mainTitle: 'Network Ports Ocean',
                subtitle: '네트워크 포트를 바다 속에서 탐험하며 학습하세요',
                searchPlaceholder: '포트 번호나 서비스명으로 검색...',
                filterAll: '전체',
                filterWellKnown: '잘 알려진 포트 (0-1023)',
                filterRegistered: '등록된 포트 (1024-49151)',
                filterDynamic: '동적 포트 (49152-65535)',
                filterTCP: 'TCP',
                filterUDP: 'UDP',
                totalPortsLabel: '총 포트 수',
                learnedPortsLabel: '학습한 포트',
                progressLabel: '학습 진도',
                security: '보안 수준',
                usage: '사용도',
                category: '카테고리',
                rfc: 'RFC 문서'
            },
            en: {
                mainTitle: 'Network Ports Ocean',
                subtitle: 'Explore and learn network ports in the ocean depths',
                searchPlaceholder: 'Search by port number or service name...',
                filterAll: 'All',
                filterWellKnown: 'Well-known Ports (0-1023)',
                filterRegistered: 'Registered Ports (1024-49151)',
                filterDynamic: 'Dynamic Ports (49152-65535)',
                filterTCP: 'TCP',
                filterUDP: 'UDP',
                totalPortsLabel: 'Total Ports',
                learnedPortsLabel: 'Learned Ports',
                progressLabel: 'Progress',
                security: 'Security Level',
                usage: 'Usage',
                category: 'Category',
                rfc: 'RFC Document'
            },
            zh: {
                mainTitle: 'Network Ports Ocean',
                subtitle: '在海洋深处探索和学习网络端口',
                searchPlaceholder: '按端口号或服务名搜索...',
                filterAll: '全部',
                filterWellKnown: '知名端口 (0-1023)',
                filterRegistered: '注册端口 (1024-49151)',
                filterDynamic: '动态端口 (49152-65535)',
                filterTCP: 'TCP',
                filterUDP: 'UDP',
                totalPortsLabel: '总端口数',
                learnedPortsLabel: '已学端口',
                progressLabel: '学习进度',
                security: '安全级别',
                usage: '使用度',
                category: '类别',
                rfc: 'RFC文档'
            },
            ja: {
                mainTitle: 'Network Ports Ocean',
                subtitle: '海の深さでネットワークポートを探索し学習',
                searchPlaceholder: 'ポート番号またはサービス名で検索...',
                filterAll: '全て',
                filterWellKnown: 'ウェルノウンポート (0-1023)',
                filterRegistered: '登録済ポート (1024-49151)',
                filterDynamic: 'ダイナミックポート (49152-65535)',
                filterTCP: 'TCP',
                filterUDP: 'UDP',
                totalPortsLabel: '総ポート数',
                learnedPortsLabel: '学習済ポート',
                progressLabel: '進捗',
                security: 'セキュリティレベル',
                usage: '使用度',
                category: 'カテゴリ',
                rfc: 'RFC文書'
            }
        };

        // Comprehensive network ports data
        const networkPorts = [
            {
                port: 21, name: 'FTP', protocol: ['TCP'], 
                description: { ko: 'File Transfer Protocol - 파일 전송 프로토콜', en: 'File Transfer Protocol', zh: '文件传输协议', ja: 'ファイル転送プロトコル' },
                category: 'File Transfer', security: 'medium', usage: 'high', rfc: 'RFC 959'
            },
            {
                port: 22, name: 'SSH', protocol: ['TCP'], 
                description: { ko: 'Secure Shell - 보안 셸 원격 접속', en: 'Secure Shell', zh: '安全外壳协议', ja: 'セキュアシェル' },
                category: 'Remote Access', security: 'high', usage: 'high', rfc: 'RFC 4253'
            },
            {
                port: 23, name: 'Telnet', protocol: ['TCP'], 
                description: { ko: 'Telnet - 원격 터미널 접속', en: 'Remote Terminal Protocol', zh: '远程终端协议', ja: 'リモートターミナルプロトコル' },
                category: 'Remote Access', security: 'low', usage: 'low', rfc: 'RFC 854'
            },
            {
                port: 25, name: 'SMTP', protocol: ['TCP'], 
                description: { ko: 'Simple Mail Transfer Protocol - 메일 전송', en: 'Simple Mail Transfer Protocol', zh: '简单邮件传输协议', ja: 'シンプルメール転送プロトコル' },
                category: 'Email', security: 'medium', usage: 'high', rfc: 'RFC 5321'
            },
            {
                port: 53, name: 'DNS', protocol: ['TCP', 'UDP'], 
                description: { ko: 'Domain Name System - 도메인 이름 시스템', en: 'Domain Name System', zh: '域名系统', ja: 'ドメインネームシステム' },
                category: 'Name Resolution', security: 'high', usage: 'critical', rfc: 'RFC 1035'
            },
            {
                port: 67, name: 'DHCP Server', protocol: ['UDP'], 
                description: { ko: 'Dynamic Host Configuration Protocol 서버', en: 'DHCP Server', zh: 'DHCP服务器', ja: 'DHCPサーバー' },
                category: 'Network Configuration', security: 'medium', usage: 'high', rfc: 'RFC 2131'
            },
            {
                port: 68, name: 'DHCP Client', protocol: ['UDP'], 
                description: { ko: 'Dynamic Host Configuration Protocol 클라이언트', en: 'DHCP Client', zh: 'DHCP客户端', ja: 'DHCPクライアント' },
                category: 'Network Configuration', security: 'medium', usage: 'high', rfc: 'RFC 2131'
            },
            {
                port: 80, name: 'HTTP', protocol: ['TCP'], 
                description: { ko: 'HyperText Transfer Protocol - 웹 트래픽', en: 'HyperText Transfer Protocol', zh: '超文本传输协议', ja: 'ハイパーテキスト転送プロトコル' },
                category: 'Web Services', security: 'low', usage: 'critical', rfc: 'RFC 7230'
            },
            {
                port: 110, name: 'POP3', protocol: ['TCP'], 
                description: { ko: 'Post Office Protocol v3 - 메일 수신', en: 'Post Office Protocol v3', zh: '邮局协议v3', ja: 'ポストオフィスプロトコルv3' },
                category: 'Email', security: 'low', usage: 'medium', rfc: 'RFC 1939'
            },
            {
                port: 143, name: 'IMAP', protocol: ['TCP'], 
                description: { ko: 'Internet Message Access Protocol - 메일 접근', en: 'Internet Message Access Protocol', zh: '互联网消息访问协议', ja: 'インターネットメッセージアクセスプロトコル' },
                category: 'Email', security: 'medium', usage: 'high', rfc: 'RFC 3501'
            },
            {
                port: 443, name: 'HTTPS', protocol: ['TCP'], 
                description: { ko: 'HTTP over TLS/SSL - 보안 웹 트래픽', en: 'HTTP over TLS/SSL', zh: 'TLS/SSL上的HTTP', ja: 'TLS/SSL上のHTTP' },
                category: 'Web Services', security: 'high', usage: 'critical', rfc: 'RFC 2818'
            },
            {
                port: 993, name: 'IMAPS', protocol: ['TCP'], 
                description: { ko: 'IMAP over TLS/SSL - 보안 IMAP', en: 'IMAP over TLS/SSL', zh: 'TLS/SSL上的IMAP', ja: 'TLS/SSL上のIMAP' },
                category: 'Email', security: 'high', usage: 'high', rfc: 'RFC 3501'
            },
            {
                port: 995, name: 'POP3S', protocol: ['TCP'], 
                description: { ko: 'POP3 over TLS/SSL - 보안 POP3', en: 'POP3 over TLS/SSL', zh: 'TLS/SSL上的POP3', ja: 'TLS/SSL上のPOP3' },
                category: 'Email', security: 'high', usage: 'medium', rfc: 'RFC 2595'
            }
        ];

        // Initialize the application
        function init() {
            allPorts = networkPorts;
            filteredPorts = allPorts;
            createBubbles();
            renderPorts();
            updateLanguage();
            loadUserProgress();
            
            // Add event listeners
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            
            // Device performance check
            checkDevicePerformance();
        }

        // Create floating bubbles
        function createBubbles() {
            if (!settings.particles) return;
            
            const bubblesContainer = document.getElementById('bubbles');
            bubblesContainer.innerHTML = '';
            
            for (let i = 0; i < 20; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                bubble.style.left = Math.random() * 100 + '%';
                bubble.style.width = bubble.style.height = Math.random() * 60 + 20 + 'px';
                bubble.style.animationDelay = Math.random() * 15 + 's';
                bubble.style.animationDuration = (Math.random() * 10 + 10) + 's';
                bubblesContainer.appendChild(bubble);
            }
        }

        // Render ports grid
        function renderPorts() {
            const grid = document.getElementById('portsGrid');
            grid.innerHTML = '';
            
            filteredPorts.forEach(port => {
                const card = createPortCard(port);
                grid.appendChild(card);
            });
            
            updateStats();
        }

        // Create individual port card
        function createPortCard(port) {
            const card = document.createElement('div');
            card.className = 'port-card';
            card.onclick = () => openPortModal(port);
            
            const protocols = port.protocol.map(p => 
                `<span class="port-protocol">${p}</span>`
            ).join('');
            
            const securityClass = `security-${port.security}`;
            
            card.innerHTML = `
                <div class="port-number">${port.port}</div>
                <div class="port-name">${port.name}</div>
                ${protocols}
                <div class="port-description">${port.description[currentLanguage]}</div>
                <div class="port-details">
                    <div class="detail-item">
                        <span class="detail-label">${translations[currentLanguage].category}:</span>
                        <span class="detail-value">${port.category}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">${translations[currentLanguage].security}:</span>
                        <span class="security-level ${securityClass}">${port.security}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">${translations[currentLanguage].usage}:</span>
                        <span class="detail-value">${port.usage}</span>
                    </div>
                </div>
            `;
            
            if (settings.effects3d) {
                card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg)';
                card.addEventListener('mousemove', (e) => {
                    if (!settings.effects3d) return;
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = (y - centerY) / 10;
                    const rotateY = (centerX - x) / 10;
                    
                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(10px)`;
                });
                
                card.addEventListener('mouseleave', () => {
                    card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateZ(0px)';
                });
            }
            
            return card;
        }

        // Open port detail modal
        function openPortModal(port) {
            const modal = document.getElementById('portModal');
            const content = document.getElementById('modalContent');
            
            // Add to learned ports
            learnedPorts.add(port.port);
            saveUserProgress();
            updateStats();
            
            const protocols = port.protocol.map(p => 
                `<span class="port-protocol">${p}</span>`
            ).join('');
            
            const securityClass = `security-${port.security}`;
            
            content.innerHTML = `
                <div class="port-number" style="font-size: 3rem; text-align: center; margin-bottom: 1rem;">
                    ${port.port}
                </div>
                <div class="port-name" style="font-size: 1.5rem; text-align: center; margin-bottom: 1rem;">
                    ${port.name}
                </div>
                <div style="text-align: center; margin-bottom: 2rem;">
                    ${protocols}
                </div>
                
                <div class="port-details">
                    <h3 style="color: #00bfff; margin-bottom: 1rem;">상세 정보</h3>
                    
                    <div class="detail-item">
                        <span class="detail-label">설명:</span>
                        <span class="detail-value">${port.description[currentLanguage]}</span>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">${translations[currentLanguage].category}:</span>
                        <span class="detail-value">${port.category}</span>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">${translations[currentLanguage].security}:</span>
                        <span class="security-level ${securityClass}">${port.security}</span>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">${translations[currentLanguage].usage}:</span>
                        <span class="detail-value">${port.usage}</span>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">프로토콜:</span>
                        <span class="detail-value">${port.protocol.join(', ')}</span>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">${translations[currentLanguage].rfc}:</span>
                        <span class="detail-value">${port.rfc}</span>
                    </div>
                </div>
                
                <div style="margin-top: 2rem; padding: 1rem; background: rgba(0,191,255,0.1); border-radius: 10px; border-left: 3px solid #00bfff;">
                    <h4 style="color: #00bfff; margin-bottom: 0.5rem;">학습 팁</h4>
                    <p>이 포트는 ${port.category} 카테고리에 속하며, ${port.security} 보안 수준을 가집니다. 
                    ${port.usage === 'critical' ? '매우 중요한' : port.usage === 'high' ? '높은' : port.usage === 'medium' ? '중간' : '낮은'} 사용빈도를 보입니다.</p>
                </div>
            `;
            
            modal.style.display = 'flex';
            
            if (settings.animations) {
                modal.style.opacity = '0';
                setTimeout(() => {
                    modal.style.opacity = '1';
                }, 10);
            }
        }

        // Close modal
        function closeModal() {
            const modal = document.getElementById('portModal');
            
            if (settings.animations) {
                modal.style.opacity = '0';
                setTimeout(() => {
                    modal.style.display = 'none';
                    modal.style.opacity = '1';
                }, 300);
            } else {
                modal.style.display = 'none';
            }
        }

        // Handle search
        function handleSearch(e) {
            const query = e.target.value.toLowerCase();
            
            if (query === '') {
                filteredPorts = allPorts;
            } else {
                filteredPorts = allPorts.filter(port => 
                    port.port.toString().includes(query) ||
                    port.name.toLowerCase().includes(query) ||
                    port.description[currentLanguage].toLowerCase().includes(query) ||
                    port.category.toLowerCase().includes(query)
                );
            }
            
            renderPorts();
        }

        // Filter ports
        function filterPorts(type) {
            // Remove active class from all filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            switch (type) {
                case 'all':
                    filteredPorts = allPorts;
                    break;
                case 'well-known':
                    filteredPorts = allPorts.filter(port => port.port <= 1023);
                    break;
                case 'registered':
                    filteredPorts = allPorts.filter(port => port.port >= 1024 && port.port <= 49151);
                    break;
                case 'dynamic':
                    filteredPorts = allPorts.filter(port => port.port >= 49152);
                    break;
                case 'tcp':
                    filteredPorts = allPorts.filter(port => port.protocol.includes('TCP'));
                    break;
                case 'udp':
                    filteredPorts = allPorts.filter(port => port.protocol.includes('UDP'));
                    break;
            }
            
            renderPorts();
        }

        // Language functions
        function setLanguage(lang) {
            if (settings.animations) {
                showTransition(() => {
                    currentLanguage = lang;
                    updateLanguage();
                    renderPorts();
                });
            } else {
                currentLanguage = lang;
                updateLanguage();
                renderPorts();
            }
            
            // Update active language button
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function updateLanguage() {
            const t = translations[currentLanguage];
            
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('searchInput').placeholder = t.searchPlaceholder;
            
            document.getElementById('filterAll').textContent = t.filterAll;
            document.getElementById('filterWellKnown').textContent = t.filterWellKnown;
            document.getElementById('filterRegistered').textContent = t.filterRegistered;
            document.getElementById('filterDynamic').textContent = t.filterDynamic;
            document.getElementById('filterTCP').textContent = t.filterTCP;
            document.getElementById('filterUDP').textContent = t.filterUDP;
            
            document.getElementById('totalPortsLabel').textContent = t.totalPortsLabel;
            document.getElementById('learnedPortsLabel').textContent = t.learnedPortsLabel;
            document.getElementById('progressLabel').textContent = t.progressLabel;
        }

        // Settings toggle functions
        function toggle3DEffects() {
            settings.effects3d = !settings.effects3d;
            document.getElementById('effects3d').classList.toggle('active', settings.effects3d);
            
            if (settings.animations) {
                showTransition(() => {
                    renderPorts();
                });
            } else {
                renderPorts();
            }
        }

        function toggleAnimations() {
            settings.animations = !settings.animations;
            document.getElementById('animations').classList.toggle('active', settings.animations);
            
            if (!settings.animations) {
                document.querySelectorAll('.port-card').forEach(card => {
                    card.style.transition = 'none';
                });
            } else {
                document.querySelectorAll('.port-card').forEach(card => {
                    card.style.transition = 'all 0.5s ease';
                });
            }
        }

        function toggleParticles() {
            settings.particles = !settings.particles;
            document.getElementById('particles').classList.toggle('active', settings.particles);
            
            if (settings.animations) {
                showTransition(() => {
                    createBubbles();
                });
            } else {
                createBubbles();
            }
        }

        function toggleSounds() {
            settings.sounds = !settings.sounds;
            document.getElementById('sounds').classList.toggle('active', settings.sounds);
        }

        // Transition animation
        function showTransition(callback) {
            const overlay = document.getElementById('transitionOverlay');
            overlay.classList.add('active');
            
            setTimeout(() => {
                callback();
                overlay.classList.remove('active');
            }, 500);
        }

        // Update statistics
        function updateStats() {
            document.getElementById('totalPorts').textContent = allPorts.length;
            document.getElementById('learnedPorts').textContent = learnedPorts.size;
            const progress = Math.round((learnedPorts.size / allPorts.length) * 100);
            document.getElementById('progress').textContent = progress + '%';
        }

        // Device performance check
        function checkDevicePerformance() {
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            
            if (!gl) {
                // Disable heavy effects on devices without WebGL
                settings.effects3d = false;
                settings.particles = false;
                document.getElementById('effects3d').classList.remove('active');
                document.getElementById('particles').classList.remove('active');
            }
            
            // Check for mobile devices
            if (window.innerWidth < 768) {
                // Reduce effects on mobile
                const bubblesContainer = document.getElementById('bubbles');
                const bubbles = bubblesContainer.children;
                for (let i = bubbles.length - 1; i >= 10; i--) {
                    bubbles[i].remove();
                }
            }
        }

        // User progress management
        function saveUserProgress() {
            // In a real application, this would save to a server or local storage
            // For this demo, we'll use a simple variable
            console.log('Progress saved:', Array.from(learnedPorts));
        }

        function loadUserProgress() {
            // In a real application, this would load from a server or local storage
            // For this demo, we'll start fresh each time
            updateStats();
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
            if (e.ctrlKey && e.key === 'f') {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
        });

        // Click outside modal to close
        document.getElementById('portModal').addEventListener('click', (e) => {
            if (e.target.id === 'portModal') {
                closeModal();
            }
        });

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', init);

        // Add more comprehensive port data
        const additionalPorts = [
            {
                port: 20, name: 'FTP Data', protocol: ['TCP'], 
                description: { ko: 'FTP 데이터 전송용 포트', en: 'FTP Data Transfer', zh: 'FTP数据传输', ja: 'FTPデータ転送' },
                category: 'File Transfer', security: 'medium', usage: 'high', rfc: 'RFC 959'
            },
            {
                port: 69, name: 'TFTP', protocol: ['UDP'], 
                description: { ko: 'Trivial File Transfer Protocol', en: 'Trivial File Transfer Protocol', zh: '简单文件传输协议', ja: '簡易ファイル転送プロトコル' },
                category: 'File Transfer', security: 'low', usage: 'medium', rfc: 'RFC 1350'
            },
            {
                port: 119, name: 'NNTP', protocol: ['TCP'], 
                description: { ko: 'Network News Transfer Protocol', en: 'Network News Transfer Protocol', zh: '网络新闻传输协议', ja: 'ネットワークニュース転送プロトコル' },
                category: 'News', security: 'medium', usage: 'low', rfc: 'RFC 977'
            },
            {
                port: 123, name: 'NTP', protocol: ['UDP'], 
                description: { ko: 'Network Time Protocol - 시간 동기화', en: 'Network Time Protocol', zh: '网络时间协议', ja: 'ネットワークタイムプロトコル' },
                category: 'Time Services', security: 'medium', usage: 'high', rfc: 'RFC 958'
            },
            {
                port: 161, name: 'SNMP', protocol: ['UDP'], 
                description: { ko: 'Simple Network Management Protocol', en: 'Simple Network Management Protocol', zh: '简单网络管理协议', ja: '簡単ネットワーク管理プロトコル' },
                category: 'Network Management', security: 'medium', usage: 'high', rfc: 'RFC 1157'
            },
            {
                port: 389, name: 'LDAP', protocol: ['TCP'], 
                description: { ko: 'Lightweight Directory Access Protocol', en: 'Lightweight Directory Access Protocol', zh: '轻量级目录访问协议', ja: 'ライトウェイトディレクトリアクセスプロトコル' },
                category: 'Directory Services', security: 'medium', usage: 'high', rfc: 'RFC 4511'
            },
            {
                port: 636, name: 'LDAPS', protocol: ['TCP'], 
                description: { ko: 'LDAP over TLS/SSL', en: 'LDAP over TLS/SSL', zh: 'TLS/SSL上的LDAP', ja: 'TLS/SSL上のLDAP' },
                category: 'Directory Services', security: 'high', usage: 'high', rfc: 'RFC 4513'
            },
            {
                port: 3306, name: 'MySQL', protocol: ['TCP'], 
                description: { ko: 'MySQL 데이터베이스 서버', en: 'MySQL Database Server', zh: 'MySQL数据库服务器', ja: 'MySQLデータベースサーバー' },
                category: 'Database', security: 'medium', usage: 'high', rfc: 'N/A'
            },
            {
                port: 5432, name: 'PostgreSQL', protocol: ['TCP'], 
                description: { ko: 'PostgreSQL 데이터베이스 서버', en: 'PostgreSQL Database Server', zh: 'PostgreSQL数据库服务器', ja: 'PostgreSQLデータベースサーバー' },
                category: 'Database', security: 'medium', usage: 'high', rfc: 'N/A'
            },
            {
                port: 6379, name: 'Redis', protocol: ['TCP'], 
                description: { ko: 'Redis 인메모리 데이터베이스', en: 'Redis In-Memory Database', zh: 'Redis内存数据库', ja: 'Redisインメモリデータベース' },
                category: 'Database', security: 'medium', usage: 'high', rfc: 'N/A'
            }
        ];

        // Merge additional ports with existing ones
        networkPorts.push(...additionalPorts);
    </script>
</body>
</html>